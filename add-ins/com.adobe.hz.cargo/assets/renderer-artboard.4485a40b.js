var Y=Object.defineProperty;var D=Object.getOwnPropertySymbols;var H=Object.prototype.hasOwnProperty,X=Object.prototype.propertyIsEnumerable;var $=(l,t,e)=>t in l?Y(l,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):l[t]=e,J=(l,t)=>{for(var e in t||(t={}))H.call(t,e)&&$(l,e,t[e]);if(D)for(var e of D(t))X.call(t,e)&&$(l,e,t[e]);return l};import{r as k}from"./text-aspect-ratio.758caee0.js";import{g as q,b as L,s as Z,$ as Q}from"./vendor.20676418.js";import{C as K,G as w,B as tt,T as et,S as st,a as _,b as it,s as C,L as R,c as A,A as at}from"./pixi.6a033cab.js";function nt(l,t=100){let e=null;return function(...s){e===null&&(e=setTimeout(function(){l.apply(this,s),e=null},t))}}class O{static get defaultMatrix(){return[1,0,0,1,0,0]}static getScalingTransform(t,e){return[t,0,0,e,0,0]}static getTranslationTransform(t,e){return[1,0,0,1,t,e]}static scale(t,e,s){const i=e[0],a=e[1],n=e[2],r=e[3],c=e[4],o=e[5],d=s[0],h=s[1];return t[0]=i*d,t[1]=a*d,t[2]=n*h,t[3]=r*h,t[4]=c,t[5]=o,t}static difference(t,e,s){return O.multiply(t,O.invert(t,e),s)}static multiply(t,e,...s){let i=e;for(let a=0;a<s.length;a+=1){const n=s[a],r=i[0],c=i[1],o=i[2],d=i[3],h=i[4],p=i[5],u=n[0],y=n[1],f=n[2],b=n[3],j=n[4],M=n[5];t[0]=r*u+o*y,t[1]=c*u+d*y,t[2]=r*f+o*b,t[3]=c*f+d*b,t[4]=r*j+o*M+h,t[5]=c*j+d*M+p,i=t}return t}static rotate(t,e,s){const i=e[0],a=e[1],n=e[2],r=e[3],c=e[4],o=e[5],d=Math.sin(s),h=Math.cos(s);return t[0]=i*h+n*d,t[1]=a*h+r*d,t[2]=i*-d+n*h,t[3]=a*-d+r*h,t[4]=c,t[5]=o,t}static translate(t,e,s){const i=e[0],a=e[1],n=e[2],r=e[3],c=e[4],o=e[5],d=s[0],h=s[1];return t[0]=i,t[1]=a,t[2]=n,t[3]=r,t[4]=i*d+n*h+c,t[5]=a*d+r*h+o,t}static transformPoint(t,e,s){return{x:t*s[0]+e*s[2]+s[4],y:t*s[1]+e*s[3]+s[5]}}static invert(t,e){const s=e[0],i=e[1],a=e[2],n=e[3],r=e[4],c=e[5];let o=s*n-i*a;return o?(o=1/o,t[0]=n*o,t[1]=-i*o,t[2]=-a*o,t[3]=s*o,t[4]=(a*c-n*r)*o,t[5]=(i*r-s*c)*o,t):(t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t)}static compose(t=0,e=0,s=0){const i=this.defaultMatrix;return this.translate(i,i,[t,e]),this.rotate(i,i,s),i}static decompose(t){const e=t[0],s=t[1],i=t[2],a=t[3],n=t[4],r=t[5],c=-Math.atan2(-i,a),o=Math.atan2(s,e),d=Math.abs(c+o),h=d<1e-5||Math.abs(Math.PI*2-d)<1e-5;return{skew:{x:h?0:c,y:h?0:o},scale:{x:Math.sqrt(e*e+s*s),y:Math.sqrt(i*i+a*a)},position:{x:n,y:r},rotation:h?o:0}}static decomposeScale(t){const e=t[0],s=t[1],i=t[2],a=t[3];return{x:Math.sqrt(e*e+s*s),y:Math.sqrt(i*i+a*a)}}}class S{static makeNodeObject({id:t=k(),type:e="container",isEffect:s=!1,isEffectNode:i=!1,variantSetId:a="",substance:n={},blendMode:r="normal",parentId:c="",width:o=0,height:d=0,x:h=0,y:p=0,rotate:u=0,data:y={}}){return{id:t,data:y,type:e,isEffect:s,isEffectNode:i,variantSetId:a,substance:n,blendMode:r,parentId:c,width:o,height:d,x:h,y:p,rotate:u,children:[],effects:[],items:[],dataCacheKey:"",placementCacheKey:"",sizeCacheKey:"",index:0,globalTransform:O.defaultMatrix}}static createNewDocumentState(){const t=this.makeNodeObject({type:"canvas"}),e={id:k(),versionTag:k(),rootNodeId:t.id,timelineDuration:0,nodes:{},author:"",tool:"",name:"",thumbnail:"",extraThumbnails:[],tags:[]};return e.nodes[t.id]=t,e}constructor(t=""){this.state=t?JSON.parse(t):S.createNewDocumentState()}preorderTraversal(t){const e=[this.state.rootNodeId];for(;e.length;){const s=e.shift(),i=this.state.nodes[s];e.push(...i.children),t(i)}}depthFirstTraversal(t){const e=[this.state.rootNodeId],s=[];for(;e.length>0;){const i=e.pop(),a=this.state.nodes[i];s.indexOf(i)>=0||a.children.length===0?t(a):(s.push(i),e.push(i,...a.children))}}indexOfChildWithinParent(t,e){const{children:s}=this.state.nodes[e];return s.indexOf(t)}setStringifiedState(t){!t||(this.state=JSON.parse(t))}forEachNode(t){Object.values(this.state.nodes).forEach(t)}findAll(t){const e=[];return this.forEachNode(s=>{t(s)&&e.push(s.id)}),e}forceInsertionAsParent(t,e){const s=this.state.nodes[t],i=this.state.nodes[e],a=this.state.nodes[i.parentId],n=a.children.indexOf(e);n>=0&&a.children.splice(n,1),i.parentId=t,s.children.push(e)}createNode({id:t,parentId:e,type:s,isEffect:i,isEffectNode:a,data:n,blendMode:r,x:c,y:o,width:d,height:h,index:p,rotate:u}){e||(e=this.state.rootNodeId);const y=this.state.nodes[e],f=S.makeNodeObject({id:t,parentId:e,type:s,isEffect:i,isEffectNode:a,data:n,blendMode:r,x:c,y:o,width:d,height:h,rotate:u});this.state.nodes[f.id]=f;const b=f.isEffect?"effects":"children";return typeof p=="number"?y.children.splice(p,0,f.id):y[b].push(f.id),f.id}updateNode(t,{parentId:e,index:s,x:i,y:a,rotate:n,width:r,height:c,blendMode:o,data:d},h=!1){const p=this.state.nodes[t],u=!h&&p.isEffect?"effects":"children";if(e&&e!==p.parentId){const y=this.state.nodes[p.parentId],f=y[u].indexOf(t);f>-1&&y[u].splice(f,1);const b=this.state.nodes[e];p.parentId=e,b[u].push(t)}if(typeof s=="number"){const y=this.state.nodes[p.parentId],f=y[u].indexOf(p.id);y[u].splice(f,1),y[u].splice(s,0,p.id)}return d&&Object.assign(p.data,d),i!==void 0&&(p.x=i),a!==void 0&&(p.y=a),o!==void 0&&(p.blendMode=o),r!==void 0&&(p.width=r),c!==void 0&&(p.height=c),n!==void 0&&(p.rotate=n),this}deleteNode(t){const e=this.state.nodes[t],s=e.isEffect?"effects":"children",i=this.state.nodes[e.parentId],a=i[s].indexOf(t);return a>-1&&i[s].splice(a,1),delete this.state.nodes[t],this}get rootNodeId(){return this.state.rootNodeId}}class ot{constructor(){this._state={cacheKey:"",data:{src:""}},this._displayObject=new K,this.isLoaded=!1,this.isLoading=!1,this._loadedNaturalWidth=1,this._loadedNaturalHeight=1,this._mask=new w,this._displayObject.addChild(this._mask)}get displayObject(){return this._displayObject}get state(){return this._state}set state(t){const e=t.dataCacheKey!==this._state.dataCacheKey||t.sizeCacheKey!==this._state.sizeCacheKey,s=t.placementCacheKey!==this._state.placementCacheKey;this.isLoaded=this._state.data.src===t.data.src,this._state=t,console.log(this._state),s&&this.place(),e&&this.render()}load(){this.isLoading=!0;const t=`${this.state.data.src}`;var e=new Image;e.crossOrigin="anonymous",e.onload=()=>{this.sprite&&(this.sprite.destroy(),delete this.sprite),this.isLoaded=!0,this.isLoading=!1,this._loadedNaturalWidth=e.naturalWidth,this._loadedNaturalHeight=e.naturalHeight;var s=new tt(e),i=new et(s);this.sprite=new st(i),this._displayObject.addChild(this.sprite),this.render()},e.src=t}place(){const{x:t,y:e,rotate:s}=this.state;this._displayObject.rotation=s,console.log("place"),console.log(this.state),this._displayObject.position.set(t,e)}render(){if(!this.isLoaded&&!this.isLoading&&this.load(),this.sprite){const{blendMode:t,width:e,height:s}=this.state,i=e/this._loadedNaturalWidth,a=s/this._loadedNaturalHeight;switch(this._mask.clear(),this._mask.beginFill(0),console.log(e,s),console.log(this._loadedNaturalWidth,this._loadedNaturalWidth),console.log(`scale: ${i}, ${a}`),t){case"multiply":this.sprite.blendMode=_.MULTIPLY;break;case"screen":this.sprite.blendMode=_.SCREEN;break;default:this.sprite.blendMode=_.NORMAL;break}this.sprite.scale.set(i,a)}}}class ct{constructor(){this._state={cacheKey:""},this._displayObject=new it(""),this._renderScale=1}get state(){return this._state}get displayObject(){return this._displayObject}set state(t){const e=t.dataCacheKey!==this._state.dataCacheKey||t.sizeCacheKey!==this._state.sizeCacheKey,s=t.placementCacheKey!==this._state.placementCacheKey;this._state=t,s&&this.place(),e&&this.render()}set renderScale(t){let e=1;t<1?e=Math.ceil(t*2)/2:e=Math.min(4,Math.ceil(t)),e!==this._renderScale&&(this._renderScale=e,this._displayObject.resolution=this._renderScale)}place(){const{x:t,y:e,rotate:s}=this.state;this._displayObject.rotation=s,this._displayObject.position.set(t,e)}render(){const{blendMode:t,data:{text:e,color:s,font:i,weight:a,style:n,size:r,letterSpacing:c,alignment:o}}=this.state;switch(t){case"multiply":this._displayObject.blendMode=_.MULTIPLY;break;case"screen":this._displayObject.blendMode=_.SCREEN;break;default:this._displayObject.blendMode=_.NORMAL;break}this._displayObject.text=e,this._displayObject.style={fontFamily:i,fontSize:r,fontStyle:n,fontWeight:a,lineHeight:r,textBaseline:"bottom",padding:Math.round(r/2),fill:C(s||"0099ff"),align:o,letterSpacing:c}}}class rt{constructor(){this._state={cacheKey:""},this._displayObject=new w}get state(){return this._state}get displayObject(){return this._displayObject}set state(t){const e=t.dataCacheKey!==this._state.dataCacheKey||t.sizeCacheKey!==this._state.sizeCacheKey,s=t.placementCacheKey!==this._state.placementCacheKey;this._state=t,s&&this.place(),e&&this.render()}place(){const{x:t,y:e,rotate:s}=this.state;this._displayObject.rotation=s,this._displayObject.position.set(t,e)}render(){const{width:t,height:e,blendMode:s,data:{color:i,borderColor:a,borderSize:n,borderRadius:r}}=this.state;switch(s){case"multiply":this._displayObject.blendMode=_.MULTIPLY;break;case"screen":this._displayObject.blendMode=_.SCREEN;break;default:this._displayObject.blendMode=_.NORMAL;break}this._displayObject.clear(),this._displayObject.beginFill(C(i||"0099ff")),n>0&&this._displayObject.lineStyle({width:n,color:C(a||"0099ff"),alignment:1,alpha:1,native:!1,cap:R.BUTT,join:A.MITER,miterLimit:10}),r>0?this._displayObject.drawRoundedRect(0,0,t,e,r):this._displayObject.drawRect(0,0,t,e),this._displayObject.endFill()}}class dt{constructor(){this._state={cacheKey:""},this._displayObject=new w}get state(){return this._state}get displayObject(){return this._displayObject}set state(t){const e=t.dataCacheKey!==this._state.dataCacheKey||t.sizeCacheKey!==this._state.sizeCacheKey,s=t.placementCacheKey!==this._state.placementCacheKey;this._state=t,s&&this.place(),e&&this.render()}place(){const{x:t,y:e,rotate:s}=this.state;this._displayObject.rotation=s,this._displayObject.position.set(t,e)}render(){const{blendMode:t,width:e,height:s,data:{color:i,borderColor:a,borderSize:n}}=this.state;switch(t){case"multiply":this._displayObject.blendMode=_.MULTIPLY;break;case"screen":this._displayObject.blendMode=_.SCREEN;break;default:this._displayObject.blendMode=_.NORMAL;break}this._displayObject.clear(),this._displayObject.beginFill(C(i||"0099ff")),n>0&&this._displayObject.lineStyle({width:n,color:C(a||"0099ff"),alignment:1,alpha:1,native:!1,cap:R.BUTT,join:A.MITER,miterLimit:10}),this._displayObject.drawEllipse(e/2,s/2,e/2,s/2),this._displayObject.endFill()}}class lt{constructor(){this._state={cacheKey:""},this._displayObject=new w}get state(){return this._state}get displayObject(){return this._displayObject}set state(t){const e=t.dataCacheKey!==this._state.dataCacheKey||t.sizeCacheKey!==this._state.sizeCacheKey,s=t.placementCacheKey!==this._state.placementCacheKey;this._state=t,s&&this.place(),e&&this.render()}place(){const{x:t,y:e,rotate:s}=this.state;this._displayObject.rotation=s,this._displayObject.position.set(t,e)}render(){const{blendMode:t,width:e,height:s,data:{color:i,borderColor:a,borderSize:n}}=this.state;switch(t){case"multiply":this._displayObject.blendMode=_.MULTIPLY;break;case"screen":this._displayObject.blendMode=_.SCREEN;break;default:this._displayObject.blendMode=_.NORMAL;break}this._displayObject.clear(),this._displayObject.beginFill(C(i||"0099ff")),n>0&&this._displayObject.lineStyle({width:n,color:C(a||"0099ff"),alignment:1,alpha:1,native:!1,cap:R.BUTT,join:A.MITER,miterLimit:10}),this._displayObject.drawCircle(e/2,s/2,e/2),this._displayObject.endFill()}}class G{constructor(){this._state={cacheKey:""},this._displayObject=new K}get state(){return this._state}get displayObject(){return this._displayObject}get childrenSlot(){return this._displayObject}set state(t){const e=t.placementCacheKey!==this._state.placementCacheKey;this._state=t,e&&this.place()}place(){const{x:t,y:e,rotate:s}=this.state;this.displayObject.rotation=s,this.displayObject.position.set(t,e)}}class ht{constructor(){this._state={cacheKey:""},this._displayObject=new K,this._childrenSlot=new K,this._background=new w,this._mask=new w,this._displayObject.addChild(this._mask),this._displayObject.addChild(this._childrenSlot),this._childrenSlot.mask=this._mask}get state(){return this._state}get displayObject(){return this._displayObject}get childrenSlot(){return this._childrenSlot}set state(t){const e=t.dataCacheKey!==this._state.dataCacheKey||t.sizeCacheKey!==this._state.sizeCacheKey,s=t.placementCacheKey!==this._state.placementCacheKey;this._state=t,s&&this.place(),e&&this.render()}place(){const{x:t,y:e,rotate:s}=this.state;this.displayObject.rotation=s,this.displayObject.position.set(t,e)}render(){const{width:t,height:e,data:{color:s}}=this.state;this._background.clear(),this._background.beginFill(C(s||"0099ff")),this._background.drawRect(0,0,t,e),this._background.endFill(),this._mask.clear(),this._mask.drawRect(0,0,t,e)}}const m=new Map;m.set("image",ot);m.set("text",ct);m.set("rectangle",rt);m.set("ellipse",dt);m.set("circle",lt);m.set("container",G);m.set("artboard",ht);m.set("artboard-group",G);m.set("canvas",G);function pt(l){const t=m.get(l);return new t}class yt{constructor(t={}){this._width=1,this._height=1,this._scale=1,this._originX=0,this._originY=0,this._displayList={},this._displayGraph=S.createNewDocumentState(),this._pixiApp=new at(t),this._stage=this._pixiApp.stage}get canvas(){return this._pixiApp.view}set displayGraph(t){this._displayGraph=t}set canvasSize({width:t,height:e}){this._pixiApp.renderer.resize(t,e)}set origin({x:t,y:e}){this._stage.x=t,this._stage.y=e}set rootId(t){this._rootId=t}set scale(t){this._scale=t}render(){const t=this._rootId||this._displayGraph.rootNodeId;if(!this._displayGraph.nodes[t])return;const e=Object.keys(this._displayList),s=[t];for(this._stage.scale.set(this._scale);s.length;){const i=s.shift(),a=this._displayGraph.nodes[i];s.push(...a.children);const n=a.id,r=e.indexOf(n);r>-1&&e.splice(r,1);let c=this._displayList[n];if(c){if(c.state.parentId!==a.parentId||c.state.index!==a.index){const o=this._displayList[a.parentId];(o?o.childrenSlot:this._stage).addChildAt(c.displayObject,a.index)}}else{const o=this._displayList[a.parentId],d=o?o.childrenSlot:this._stage;c=pt(a.type),this._displayList[n]=c,d.addChildAt(c.displayObject,a.index)}c.renderScale=this._scale,c.state=a}e.forEach(i=>{const a=this._displayList[i];delete this._displayList[i],setTimeout(()=>{const{displayObject:n}=a;n&&n.destroy({children:!0,texture:!0,baseTexture:!0})},0)})}}class g{static apply({effectInput:t}){return J({},t)}}class ut extends g{}class ft extends g{}class _t extends g{static apply({effectInput:t}){const{value:e,inA:s,inB:i,outA:a,outB:n}=t,r=Math.min(s,i),c=Math.max(s,i),o=Math.min(c,Math.max(r,e)),d=i-s,h=n-a,p=(o-s)/d;return{value:a+p*h}}}class bt extends g{static apply({effectInput:t}){const{object:e,color:s,size:i,alignment:a}=t,n=JSON.parse(JSON.stringify(e)),r=e.nodeType;return n.nodes.push({type:"effect-stroke",isEffectNode:!0,width:e.width,height:e.height,data:{color:s,size:i,alignment:a,shape:r}}),{object:n}}}class gt extends g{static apply({effectInput:t}){const{object:e,color:s,opacity:i}=t,a=JSON.parse(JSON.stringify(e));return a.nodes.push({type:"effect-overlay",isEffectNode:!0,width:e.width,height:e.height,data:{color:s,opacity:i}}),{object:a}}}class Ot{static apply({effectInput:t}){const{A:e,B:s}=t;return{value:e+s}}}class mt extends g{static apply({effectInput:t}){const{A:e,B:s}=t;return{value:e-s}}}class jt extends g{static apply({effectInput:t}){const{A:e,B:s}=t;return{value:e*s}}}class Nt extends g{static apply({effectInput:t}){const{frequency:e,amplitude:s,x:i}=t;return e?{y:s*Math.sin(i/e)}:{y:0}}}class xt extends g{static apply({effectInput:t}){const{object:e,x:s,y:i}=t,a=JSON.parse(JSON.stringify(e));return O.translate(a.placement,a.placement,[s,i]),{object:a}}}class Mt extends g{static apply({effectInput:t}){const{object:e}=t;return e}}class Ct extends g{static apply({constants:t}){const{time:e}=t;return{seconds:e}}}const vt={"graph-input":ut,"graph-output":ft,"map-range":_t,"decompose-object":Mt,add:Ot,subtract:mt,multiply:jt,oscillate:Nt,stroke:bt,overlay:gt,translate:xt,time:Ct};function wt(l){return vt[l]}class x{static areInputsSatisfied(t={}){const e=Object.keys(t);for(let s=e.length-1;s>=0;s-=1)if(typeof t[e[s]].value=="undefined")return!1;return!0}static extractValues(t={}){const e={};return Object.keys(t).forEach(s=>{e[s]=t[s].value}),e}static insertValues(t,e={}){const s={};return Object.keys(t).forEach(i=>{const a=e[i];a&&(a.value=t[i])}),s}static pipeNodeOutputsAlongAdjacencyList(t,e){const s={},i=e.nodes[t],a=Object.keys(i.output);for(let n=a.length-1;n>=0;n-=1){const r=a[n],{value:c}=i.output[r],o=`${t}:output:${a[n]}`,d=e.adjacencyList[o];if(d)for(let h=d.length-1;h>=0;h-=1){const[p,,u]=d[h].split(":"),y=e.nodes[p];y&&(y.input[u].value=c,s[p]=!0)}}return Object.keys(s)}static applyEffectGraphToDocumentNode(t,e,s={},i){const a=JSON.parse(JSON.stringify(i)),n=a.nodes.in,r=Object.keys(a.nodes),c=[];for(s.object=t,x.insertValues(s,n.output),r.forEach(d=>{x.areInputsSatisfied(a.nodes[d].input)&&c.push(d)});c.length>0;){const d=c.pop(),h=a.nodes[d],p=h.type,u=wt(p),y=x.extractValues(h.input),f=p==="graph"?x.applyEffectGraphToDocumentNode(t,e,y,h.graph):u.apply({effectInput:y,constants:e});x.insertValues(f,h.output);const b=x.pipeNodeOutputsAlongAdjacencyList(d,a);for(let j=b.length-1;j>=0;j-=1){const M=b[j],I=a.nodes[M];x.areInputsSatisfied(I.input)&&c.push(M)}}const o=a.nodes.out.input.object.value;return o||(t||console.warn(`Executing effect graph ${i.displayName} did not yield a result. Ensure effect is properly structured.`),t)}}class Rt{constructor(){this.currentDocumentStateVersionTag="",this.displayedContentNodes=[],this.displayGraphModel=new S}get staticDisplayGraphState(){return JSON.parse(JSON.stringify(this.displayGraphModel.state))}applyEffectToNodeId(t,e,s){const i=this.displayGraphModel.state.nodes[t],a=i.data.graph,n={};return Object.assign(n,i.data),delete n.graph,e=x.applyEffectGraphToDocumentNode(e,s,n,a),e}generateDisplayGraphFromStringifiedState(t,e=0){this.displayedContentNodes=[],this.displayGraphModel.setStringifiedState(t);const s=[[this.displayGraphModel.state.rootNodeId,O.defaultMatrix]],i=[],a=[];for(;s.length;){const n=s.pop(),r=n[0],c=n[1],o=this.displayGraphModel.state.nodes[r],{type:d,parentId:h,blendMode:p,children:u,x:y,y:f,rotate:b,width:j,height:M,effects:I}=o;d==="artboard"?a.unshift(r):d!=="container"&&d!=="canvas"&&i.unshift(r);const E=O.compose(y,f,b),V=h?this.displayGraphModel.indexOfChildWithinParent(r,h):0;if(o.effects.length>0){let N={placement:E,nodes:[],nodeType:o.type,width:j,height:M,time:e};const B={time:e};for(let v=I.length-1;v>=0;v-=1){const W=I[v];N=this.applyEffectToNodeId(W,N,B)}const{position:F,rotation:U}=O.decompose(N.placement),P=this.displayGraphModel.createNode({id:`${o.id}:placement`,parentId:h,index:V,type:"container",data:{},x:F.x,y:F.y,rotate:U,blendMode:p,width:j,height:M});this.displayGraphModel.updateNode(r,{parentId:P,index:0,x:0,y:0,blendMode:"normal",rotate:0}),N.nodes.forEach(v=>{v.parentId||(v.parentId=P),this.displayGraphModel.createNode(v)}),o.globalTransform=O.multiply([],c,N.placement),o.index=0}else o.globalTransform=O.multiply([],c,E),o.index=V;o.dataCacheKey=`${JSON.stringify(o.data)}:${o.blendMode}`,o.placementCacheKey=E.join(":"),o.sizeCacheKey=`${o.width}:${o.height}`;for(let N=0;N<u.length;N+=1)s.push([u[N],o.globalTransform])}return this.displayedContentNodes=[this.displayGraphModel.rootNodeId,...a,...i],this.displayGraphModel.state}generateDisplayGraphFromDocumentModel(t,e=0){return this.currentDocumentStateVersionTag===t.state.versionTag?this.displayGraphModel.state:(this.currentDocumentStateVersionTag=`${t.state.versionTag}:${e}`,this.generateDisplayGraphFromStringifiedState(t.stringify(),e))}}var St=Object.defineProperty,Tt=Object.getOwnPropertyDescriptor,z=(l,t,e,s)=>{for(var i=s>1?void 0:s?Tt(t,e):t,a=l.length-1,n;a>=0;a--)(n=l[a])&&(i=(s?n(t,e,i):n(i))||i);return s&&i&&St(t,e,i),i};const It=500;class T extends Z{constructor(){super(),this.displayGraph={},this.id="",this.scale=1,this._displayGraphVersion="",this._width=362,this._height=267,this._originOffsetX=0,this._originOffsetY=0,this.renderer=new yt({transparent:!0,antialias:!0,resolution:2}),this.throttledUpdateCanvasSize=nt(this.updateCanvasSize.bind(this),It)}updateCanvasSize(){this.renderer.canvasSize={width:this._width,height:this._height}}shouldUpdate(t){let e=!1;if(t.has("displayGraph")){const{versionTag:s}=this.displayGraph;this._displayGraphVersion!==s&&(this._displayGraphVersion=s,e=!0)}if(t.has("id")&&(e=!0),t.has("scale")&&this.throttledUpdateCanvasSize(),(t.has("width")||t.has("height"))&&this.throttledUpdateCanvasSize(),e){const s=this.displayGraph.nodes[this.id];if(s){const{x:i,y:a,width:n,height:r}=s,c=Math.round(n*this.scale),o=Math.round(r*this.scale);console.log(o,c),this._originOffsetX=-i*this.scale,this._originOffsetY=-a*this.scale,(o!==this._height||c!==this._width)&&(this._width=c,this._height=o,this.throttledUpdateCanvasSize())}}return e}render(){return this.renderer.displayGraph=this.displayGraph,this.renderer.rootId=this.id,this.renderer.origin={x:this._originOffsetX,y:this._originOffsetY},this.renderer.scale=this.scale,this.renderer.render(),Q`<div style="width:${this._width}px;height:${this._height}px;">${this.renderer.canvas}</div>`}}T.styles=q`
    :host {
      display: inline-block;
      position: relative;
    }
    div {
      overflow: hidden;
    }
    canvas {
      display: inline-block;
      position: relative;
      transform: scale(0.5);
      transform-origin: top left;
    }
  `;z([L({type:Object})],T.prototype,"displayGraph",2);z([L({type:String})],T.prototype,"id",2);z([L({type:Number})],T.prototype,"scale",2);customElements.define("renderer-artboard",T);export{Rt as D,O as M,yt as R,nt as t};
